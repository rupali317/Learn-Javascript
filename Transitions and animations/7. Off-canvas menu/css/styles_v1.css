:root {
  --color-1: hsl(148, 32%, 65%);
  --color-2: hsl(0, 2%, 10%);
  --color-3: hsl(0, 0%, 5%);
  --font-size-1: 1rem;
  --font-size-2: 1.5rem;
  --space-none: 0rem;
  --space-1: 1rem;
  --space-2: 0.0625rem;
  --space-3: 10rem;
}

body {
  display: flex;
  font-size: var(--font-size-1);
  background-color: var(--color-1);
  color: var(--color-2);
  min-height: 100vh;
  font-family: sans-serif;
  transition: transform linear 1s;

  &:has(menu.menu-closed) {
    transform: translateX(calc(-1 * var(--space-3)));
  }
}

menu {
  background-color: var(--color-2);
  color: var(--color-1);
  list-style-type: none;
  min-width: var(--space-3);

  li {
    padding: var(--space-1);
    cursor: pointer;

    &:hover {
      background-color: var(--color-3);
    }
  }
}

main {
  padding: var(--space-1);

  p {
    font-size: var(--font-size-2);
  }

  button {
    background-color: var(--color-2);
    color: var(--color-1);
    border: var(--space-2) solid var(--color-2);
    margin-top: var(--space-1);
    transition: background-color linear 0.5s;

    &:hover {
      background-color: var(--color-1);
      color: var(--color-2);
      cursor: pointer;
    }
  }
}

/*

I notice a very strange behaviour when it comes to animation. When I load the screen for the first time, 
I see that the menu slides to the left of the screen. This is the strange behaviour. The screen should 
have just showed the content in main when loaded for the first time. I wonder why?

What‚Äôs actually happening

Key lines:

body {
  transition: transform linear 1s;

  &:has(menu.menu-closed) {
    transform: translateX(calc(-1 * var(--space-3)));
  }
}


And your HTML loads with:

<menu class="menu-closed">

Timeline on first load

Browser starts rendering

Default body { transform: none }

CSS is applied

menu.menu-closed exists

body:has(menu.menu-closed) becomes true

transform changes from none ‚Üí translateX(...)

But you told the browser:

transition: transform 1s;


So the browser politely says:

‚ÄúAh, a transform change? Let me animate that for you.‚Äù

üí• Result:
You see the menu slide left on initial load, even though the menu is already closed.

Why this feels strange (but isn‚Äôt a bug)

CSS transitions do not know your intent

Any change from an initial computed value ‚Üí final value will animate

:has() is evaluated after the initial style resolution

So this counts as a transition-triggering change

This is 100% expected browser behavior.

:has() is special because it‚Äôs a relational selector:

It depends on other elements

It‚Äôs not just ‚Äústyle this element‚Äù

It‚Äôs more like ‚Äústyle this element if the DOM satisfies a condition‚Äù

Because of that, browsers treat it more like::hover, :focus, :checked

These are evaluated after the base style pass.

*/
